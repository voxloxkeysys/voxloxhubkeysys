local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")
local TweenService = game:GetService("TweenService")

-- نظام الألوان (أسود وذهبي)
local colorScheme = {
    background = Color3.fromRGB(20, 20, 25),
    primary = Color3.fromRGB(255, 215, 0), -- ذهبي
    text = Color3.fromRGB(245, 245, 245),
    error = Color3.fromRGB(255, 85, 85)
}

-- مفتاح التخزين
local PASSWORD_KEY = "VOXLOX_SAVED_PASSWORD"

-- التحقق من وجود كلمة مرور محفوظة
local function getSavedPassword()
    return pcall(function()
        return readfile("voxlox_config.txt")
    end)
end

-- حفظ كلمة المرور
local function savePassword(password)
    writefile("voxlox_config.txt", password)
end

-- إنشاء واجهة منتصف الشاشة القابلة للسحب
local function createDraggableUI()
    local player = Players.LocalPlayer
    local playerGui = player:WaitForChild("PlayerGui")
    
    -- تنظيف الواجهات القديمة
    if playerGui:FindFirstChild("VoxLoxDraggableUI") then
        playerGui.VoxLoxDraggableUI:Destroy()
    end

    -- العناصر الرئيسية
    local ScreenGui = Instance.new("ScreenGui")
    ScreenGui.Name = "VoxLoxDraggableUI"
    ScreenGui.ResetOnSpawn = false

    -- الإطار الرئيسي (في منتصف الشاشة)
    local MainFrame = Instance.new("Frame")
    MainFrame.Size = UDim2.new(0, 300, 0, 245)
    MainFrame.Position = UDim2.new(0.5, -150, 0.5, -100) -- منتصف الشاشة
    MainFrame.AnchorPoint = Vector2.new(0.5, 0.5)
    MainFrame.BackgroundColor3 = colorScheme.background
    MainFrame.BorderSizePixel = 0
    MainFrame.Active = true

    -- تأثيرات الإطار
    local FrameCorner = Instance.new("UICorner")
    FrameCorner.CornerRadius = UDim.new(0, 12)
    FrameCorner.Parent = MainFrame

    local FrameStroke = Instance.new("UIStroke")
    FrameStroke.Color = colorScheme.primary
    FrameStroke.Thickness = 2
    FrameStroke.Parent = MainFrame

    -- شريط العنوان للسحب
    local DragBar = Instance.new("Frame")
    DragBar.Size = UDim2.new(1, 0, 0, 30)
    DragBar.BackgroundColor3 = colorScheme.primary
    DragBar.BorderSizePixel = 0

    local Title = Instance.new("TextLabel")
    Title.Text = "VOXLOX SYSTEM"
    Title.Size = UDim2.new(1, -40, 1, 0)
    Title.Position = UDim2.new(0, 10, 0, 0)
    Title.Font = Enum.Font.GothamBold
    Title.TextColor3 = colorScheme.background
    Title.BackgroundTransparency = 1
    Title.TextSize = 18
    Title.TextXAlignment = Enum.TextXAlignment.Left

    -- حقل إدخال كلمة السر
    local PasswordBox = Instance.new("TextBox")
    PasswordBox.PlaceholderText = "Enter Password"
    PasswordBox.Size = UDim2.new(0, 260, 0, 40)
    PasswordBox.Position = UDim2.new(0.5, -130, 0.4, -20)
    PasswordBox.Font = Enum.Font.Gotham
    PasswordBox.Text = ""
    PasswordBox.TextSize = 16
    PasswordBox.TextColor3 = colorScheme.text
    PasswordBox.PlaceholderColor3 = Color3.fromRGB(150, 150, 150)
    PasswordBox.BackgroundColor3 = Color3.fromRGB(40, 40, 50)

    local PasswordCorner = Instance.new("UICorner")
    PasswordCorner.CornerRadius = UDim.new(0, 8)
    PasswordCorner.Parent = PasswordBox

    -- زر التنفيذ
    local ExecuteButton = Instance.new("TextButton")
    ExecuteButton.Text = "ACTIVATE"
    ExecuteButton.Size = UDim2.new(0, 120, 0, 40)
    ExecuteButton.Position = UDim2.new(0.5, -60, 0.7, 0)
    ExecuteButton.Font = Enum.Font.GothamBold
    ExecuteButton.TextColor3 = colorScheme.background
    ExecuteButton.BackgroundColor3 = colorScheme.primary
    ExecuteButton.TextSize = 16

    local ButtonCorner = Instance.new("UICorner")
    ButtonCorner.CornerRadius = UDim.new(0, 8)
    ButtonCorner.Parent = ExecuteButton

    -- رسائل النظام
    local MessageLabel = Instance.new("TextLabel")
    MessageLabel.Text = ""
    MessageLabel.Size = UDim2.new(1, -20, 0, 20)
    MessageLabel.Position = UDim2.new(0, 10, 0.9, -10)
    MessageLabel.Font = Enum.Font.Gotham
    MessageLabel.TextSize = 14
    MessageLabel.BackgroundTransparency = 1
    MessageLabel.TextColor3 = colorScheme.primary

    -- تجميع العناصر
    DragBar.Parent = MainFrame
    Title.Parent = DragBar
    PasswordBox.Parent = MainFrame
    ExecuteButton.Parent = MainFrame
    MessageLabel.Parent = MainFrame
    MainFrame.Parent = ScreenGui
    ScreenGui.Parent = playerGui

    -- متغيرات السحب
    local dragging = false
    local dragInput, dragStart, startPos

    -- نظام سحب الواجهة
    local function updateInput(input)
        local delta = input.Position - dragStart
        MainFrame.Position = UDim2.new(
            startPos.X.Scale, startPos.X.Offset + delta.X,
            startPos.Y.Scale, startPos.Y.Offset + delta.Y
        )
    end

    DragBar.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            dragging = true
            dragStart = input.Position
            startPos = MainFrame.Position
            
            input.Changed:Connect(function()
                if input.UserInputState == Enum.UserInputState.End then
                    dragging = false
                end
            end)
        end
    end)

    DragBar.InputChanged:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseMovement then
            dragInput = input
        end
    end)

    UserInputService.InputChanged:Connect(function(input)
        if input == dragInput and dragging then
            updateInput(input)
        end
    end)

    -- وظيفة تنفيذ السكربت
    local function executeScript()
        MessageLabel.Text = "Executing VOXLOX..."
        MessageLabel.TextColor3 = colorScheme.primary
        
        -- حفظ كلمة المرور
        savePassword(PasswordBox.Text)
        
        -- حركة نزول الواجهة
        local exitTween = TweenService:Create(MainFrame, TweenInfo.new(0.5), {
            Position = UDim2.new(0.5, -150, 1.5, 0)
        })
        exitTween:Play()
        exitTween.Completed:Wait()
        
        loadstring(game:HttpGet("https://raw.githubusercontent.com/voxloxstore/voxloxhub/refs/heads/main/VOXLOX%20HUB%20-%20Auto%20Kill%20%2B%20Auto%20ReJoin%20Server-Hop%20GUI%20Script.lua"))()
        ScreenGui:Destroy()
    end

    -- التحقق من كلمة السر
    ExecuteButton.MouseButton1Click:Connect(function()
        if PasswordBox.Text == "VOXLOX_STORE_AUTOKILL-akvoid22" then
            executeScript()
        else
            MessageLabel.Text = "INCORRECT PASSWORD"
            MessageLabel.TextColor3 = colorScheme.error
            task.wait(1.5)
            player:Kick("Invalid VOXLOX Access")
        end
    end)

    -- تفعيل زر Enter
    UserInputService.InputBegan:Connect(function(input, gameProcessed)
        if input.KeyCode == Enum.KeyCode.Return then
            if PasswordBox.Text == "VOXLOX_STORE_AUTOKILL-akvoid22" then
                executeScript()
            else
                ExecuteButton.MouseButton1Click:Fire()
            end
        end
    end)
    
    -- التحقق من وجود كلمة مرور محفوظة
    local success, savedPassword = getSavedPassword()
    if success and savedPassword == "VOXLOX_STORE_AUTOKILL-akvoid22" then
        PasswordBox.Text = savedPassword
        task.wait(0.5)
        executeScript()
    end
end

-- تنشيط الواجهة
if game:IsLoaded() then
    createDraggableUI()
else
    game.Loaded:Wait()
    createDraggableUI()
end
